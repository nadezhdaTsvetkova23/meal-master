<!DOCTYPE html>
<html lang="en">
<head th:insert="fragments/head.html :: head"></head>
<body>
<nav th:replace="fragments/navbar.html :: navbar"></nav>
<div class="container-fluid white">
    <div class="row">
        <div class="col create-recipe">
            <h2 th:text="${recipe.name} + ' - Edit Feedback'"></h2>
            <form class="row g-3" th:action="@{'/editFeedback/' + ${feedback.getId()}}" method="POST">
                <input type="hidden" name="recipeId" th:value="${feedback.getId()}"/>

                <!-- User Name Field -->
                <div class="col-md-6">
                    <label for="userName" class="form-label">Your Name</label>
                    <input type="text" class="form-control" id="userName" name="userName" th:value="${feedback.userName}" required>
                </div>

                <!-- Star Rating System -->
                <div class="col-md-6">
                    <label class="form-label">Rating</label>
                    <div id="star-rating" class="feedback-stars">
                        <i class="bi bi-star" data-value="1"></i>
                        <i class="bi bi-star" data-value="2"></i>
                        <i class="bi bi-star" data-value="3"></i>
                        <i class="bi bi-star" data-value="4"></i>
                        <i class="bi bi-star" data-value="5"></i>
                        <input type="hidden" name="score" id="score" th:value="${feedback.score}" required>
                    </div>
                </div>


                <!-- Comment Field -->
                <div class="col-md-12">
                    <label for="comment" class="form-label">Comment (optional)</label>
                    <textarea name="comment" style="height: 108px;" class="form-control" id="comment" th:text="${feedback.comment}"></textarea>
                </div>

                <!-- Submit Button -->
                <div class="col-12">
                    <button class="btn btn-recipe" type="submit">Update Feedback</button>
                </div>
            </form>
        </div>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        let currentRating = document.getElementById('score').value || 0;
        updateStars(currentRating);

        document.querySelectorAll('#star-rating .bi').forEach(function(star, index) {
            star.addEventListener('click', function() {
                let rating = index + 1;
                document.getElementById('score').value = rating;
                updateStars(rating);
            });

            star.addEventListener('mouseover', function() {
                updateStars(index + 1);
            });

            star.addEventListener('mouseout', function() {
                updateStars(document.getElementById('score').value || 0);
            });
        });
    });

    function updateStars(rating) {
        document.querySelectorAll('#star-rating .bi').forEach(function (star, index) {
            if (index < rating) {
                star.classList.add('bi-star-fill');
                star.classList.remove('bi-star');
                star.classList.add('yellow-star');
            } else {
                star.classList.remove('bi-star-fill');
                star.classList.add('bi-star');
                star.classList.remove('yellow-star');
            }
        });
    }

</script>

</body>
<div th:replace="fragments/footer.html :: footer"></div>
</html>


